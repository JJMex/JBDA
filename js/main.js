document.addEventListener("DOMContentLoaded",()=>{let n=document.getElementById("page-transition-overlay"),e=document.getElementById("preloader"),t=(window.addEventListener("pageshow",()=>{n&&n.classList.add("hidden")}),e&&(sessionStorage.getItem("jbda_preloader_shown")?e.style.display="none":setTimeout(()=>{e.classList.add("preloader-hidden"),sessionStorage.setItem("jbda_preloader_shown","true")},900)),document.getElementById("cursor-led"));window.addEventListener("mousemove",e=>{t&&(t.style.transform=`translate(${e.clientX}px, ${e.clientY}px) translate(-50%, -50%)`),document.documentElement.style.setProperty("--mouse-x",e.clientX+"px"),document.documentElement.style.setProperty("--mouse-y",e.clientY+"px")}),document.querySelectorAll("a, button, summary, input[type=range], #terminal-toggle").forEach(e=>{e.addEventListener("mouseenter",()=>{t&&t.classList.add("tx-rx")}),e.addEventListener("mouseleave",()=>{t&&t.classList.remove("tx-rx")})});let a;"undefined"!=typeof Lenis&&(a=new Lenis({duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),direction:"vertical",smooth:!0}),requestAnimationFrame(function e(t){a.raf(t),requestAnimationFrame(e)}));let s=document.getElementById("mobile-menu-btn"),o=document.getElementById("nav-links"),r=!1;s&&o&&s.addEventListener("click",()=>{o.classList.toggle("active"),(r=!r)?s.innerHTML='<svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>':s.innerHTML='<svg viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>'}),document.querySelectorAll("a").forEach(e=>{!e.href||e.target||e.id.includes("calendly")||e.addEventListener("click",function(e){var t=this.getAttribute("href");t&&t.startsWith("#")?(e.preventDefault(),r&&s&&(o.classList.remove("active"),r=!1,s.innerHTML='<svg viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>'),void 0!==a?a.scrollTo(t):document.querySelector(t).scrollIntoView({behavior:"smooth"})):(this.hostname===window.location.hostname||t.startsWith(".")||t.startsWith("/"))&&(e.preventDefault(),n?(n.classList.remove("hidden"),setTimeout(()=>{window.location.href=this.href},400)):window.location.href=this.href)})});class i{constructor(e){this.el=e,this.chars="!<>-_\\/[]{}—=+*^?#_010101",this.update=this.update.bind(this)}setText(t){var n=this.el.innerText,a=Math.max(n.length,t.length),e=new Promise(e=>this.resolve=e);this.queue=[];for(let e=0;e<a;e++){var s=n[e]||"",o=t[e]||"",r=Math.floor(40*Math.random()),i=r+Math.floor(40*Math.random());this.queue.push({from:s,to:o,start:r,end:i})}return cancelAnimationFrame(this.frameRequest),this.frame=0,this.update(),e}update(){let r="",i=0;for(let o=0,e=this.queue.length;o<e;o++){let{from:e,to:t,start:n,end:a,char:s}=this.queue[o];this.frame>=a?(i++,r+=t):this.frame>=n?((!s||Math.random()<.28)&&(s=this.randomChar(),this.queue[o].char=s),r+=`<span class="dud">${s}</span>`):r+=e}this.el.innerHTML=r,i===this.queue.length?this.resolve():(this.frameRequest=requestAnimationFrame(this.update),this.frame++)}randomChar(){return this.chars[Math.floor(Math.random()*this.chars.length)]}}var c=document.querySelectorAll(".scramble-text");let l=new IntersectionObserver(e=>{e.forEach(e=>{var t,n;e.isIntersecting&&!e.target.scrambled&&(t=new i(e.target),n=e.target.getAttribute("data-original")||e.target.innerText,e.target.setAttribute("data-original",n),t.setText(n),e.target.scrambled=!0)})},{threshold:.1});c.forEach(e=>{e.setAttribute("data-original",e.innerText),e.innerHTML="&nbsp;",l.observe(e)});c=document.getElementById("dark-mode-toggle");let d=document.getElementById("moon-icon"),m=document.getElementById("sun-icon");"dark"===localStorage.getItem("jbda_theme")&&(document.body.classList.add("dark-theme"),d)&&m&&(d.style.display="none",m.style.display="block"),c&&c.addEventListener("click",()=>{document.body.classList.toggle("dark-theme"),document.body.classList.contains("dark-theme")?(localStorage.setItem("jbda_theme","dark"),d&&(d.style.display="none"),m&&(m.style.display="block")):(localStorage.setItem("jbda_theme","light"),d&&(d.style.display="block"),m&&(m.style.display="none"))});c=document.getElementById("traffic-slider");let u=document.getElementById("metric-users"),h=document.getElementById("metric-rps"),g=document.getElementById("metric-status"),y=document.getElementById("bar-trad"),v=document.getElementById("bar-jbda"),p=document.getElementById("status-trad"),E=document.getElementById("status-jbda"),f=document.getElementById("cpu-trad"),L=document.getElementById("cpu-jbda");c&&y&&v&&c.addEventListener("input",e=>{var e=parseInt(e.target.value),t="en"===document.documentElement.lang,n=Math.floor(150+248.5*e),a=Math.floor(300+1497*e);u.innerText=n.toLocaleString(),h.innerText=a.toLocaleString(),g.classList.remove("status-green","status-yellow","status-red"),e<40?(g.innerText=t?"Stable":"Estable",g.classList.add("status-green")):e<75?(g.innerText=t?"Warning (Peak)":"Riesgo (Pico)",g.classList.add("status-yellow")):(g.innerText=t?"CRITICAL / OVERLOAD":"CRÍTICO / SOBRECARGA",g.classList.add("status-red"));let s=5+1.5*e;100<s&&(s=100),y.style.width=s+"%";n=Math.min(100,Math.floor(15+.95*e)),75<e?(y.style.backgroundColor="#ef4444",y.parentElement.parentElement.classList.add("alert-shake"),p.innerText=t?"Latency: 999ms (FAILURE)":"Latencia: 999ms (CAÍDA)",p.className="status status-red",f.innerText=t?"CPU: 100% (CRASH)":"CPU: 100% (COLAPSO)",f.className="cpu-load status-red"):40<e?(y.style.backgroundColor="#f59e0b",y.parentElement.parentElement.classList.remove("alert-shake"),a=Math.floor(65+8*(e-50)),p.innerText=t?`Latency: ${a}ms`:`Latencia: ${a}ms`,p.className="status status-yellow",f.innerText=`CPU: ${n}%`,f.className="cpu-load status-yellow"):(y.style.backgroundColor="#10b981",y.parentElement.parentElement.classList.remove("alert-shake"),a=Math.floor(15+e),p.innerText=t?`Latency: ${a}ms`:`Latencia: ${a}ms`,p.className="status status-green",f.innerText=`CPU: ${n}%`,f.className="cpu-load status-green"),a=5+.15*e,n=Math.floor(12+.33*e),e=12+Math.floor(.05*e);v.style.width=a+"%",v.style.backgroundColor="var(--pink-premium)",E.innerText=t?`Latency: ${e}ms (99.8% QoS)`:`Latencia: ${e}ms (99.8% QoS)`,L.innerText=t?`CPU: ${n}% (Load Balanced)`:`CPU: ${n}% (Balanceo Activo)`});document.querySelectorAll(".magnetic-btn").forEach(a=>{a.addEventListener("mousemove",e=>{var t=a.getBoundingClientRect(),n=t.width/2,n=e.clientX-t.left-n,n=(a.style.transform=`translate(${.3*n}px, ${.3*(e.clientY-t.top-t.height/2)}px)`,e.clientX-t.left),e=e.clientY-t.top;a.style.setProperty("--x",n+"px"),a.style.setProperty("--y",e+"px")}),a.addEventListener("mouseleave",()=>{a.style.transform="translate(0px, 0px)"})});c=document.querySelectorAll(".counter-val");if(0<c.length){let r=new IntersectionObserver(e=>{e.forEach(o=>{if(o.isIntersecting){let e=parseFloat(o.target.getAttribute("data-target")),t="true"===o.target.getAttribute("data-decimal");let n=e/93.75,a=0,s=()=>{(a+=n)<e?(o.target.innerText=t?a.toFixed(1):Math.ceil(a),requestAnimationFrame(s)):o.target.innerText=e};s(),r.unobserve(o.target)}})},{threshold:.5});c.forEach(e=>r.observe(e))}setTimeout(()=>{var e=document.querySelectorAll(".card, .team-card, details");if(0<e.length){let t=new IntersectionObserver(e=>{e.forEach(e=>{!e.target.classList.contains("aos-animate")&&e.target.hasAttribute("data-aos")||(e.isIntersecting?(e.target.classList.add("scroll-focused"),e.target.classList.remove("scroll-dimmed")):(e.target.classList.remove("scroll-focused"),e.target.classList.add("scroll-dimmed")))})},{rootMargin:"-25% 0px -25% 0px"});e.forEach(e=>t.observe(e))}},1200);let b=document.getElementById("network-canvas");if(b){let o=b.getContext("2d"),r,i,l=[],s={x:null,y:null,radius:150},t=null,d=!0;window.addEventListener("mousemove",function(e){var t=b.getBoundingClientRect();s.x=e.clientX-t.left,s.y=e.clientY-t.top}),window.addEventListener("mouseout",function(){s.x=void 0,s.y=void 0});c=document.querySelector("header");c&&new IntersectionObserver(e=>{e.forEach(e=>{(d=e.isIntersecting)&&!t?x():!d&&t&&(cancelAnimationFrame(t),t=null)})},{rootMargin:"100px"}).observe(c);class A{constructor(){this.x=Math.random()*b.width,this.y=Math.random()*b.height,this.baseX=this.x,this.baseY=this.y,this.wanderAngle=Math.random()*Math.PI*2,this.vx=0,this.vy=0,this.radius=2.5*Math.random()+2}update(){var e,t,n,a;this.wanderAngle+=.01,this.baseX+=.2*Math.cos(this.wanderAngle),this.baseY+=.2*Math.sin(this.wanderAngle),(this.baseX<0||this.baseX>r)&&(this.baseX=Math.random()*r),(this.baseY<0||this.baseY>i)&&(this.baseY=Math.random()*i),null!=s.x&&null!=s.y&&(n=s.x-this.x,a=s.y-this.y,(e=Math.sqrt(n*n+a*a))<s.radius)&&(o.beginPath(),o.moveTo(this.x,this.y),o.lineTo(s.x,s.y),t=document.body.classList.contains("dark-theme"),o.strokeStyle=t?`rgba(244, 114, 182, ${.4-e/s.radius*.4})`:`rgba(212, 0, 109, ${.2-e/s.radius*.2})`,o.lineWidth=1,o.stroke(),t=n/e,n=a/e,a=(s.radius-e)/s.radius,this.vx-=t*a*1.5,this.vy-=n*a*1.5);this.vx+=.05*(this.baseX-this.x),this.vy+=.05*(this.baseY-this.y),this.vx*=.85,this.vy*=.85,this.x+=this.vx,this.y+=this.vy}draw(){var e=document.body.classList.contains("dark-theme");o.fillStyle=e?"rgba(244, 114, 182, 0.4)":"rgba(212, 0, 109, 0.2)",o.beginPath(),o.arc(this.x,this.y,this.radius,0,2*Math.PI),o.fill()}}function w(){r=b.width=window.innerWidth,i=b.height=document.querySelector("header").offsetHeight,l=[];var t=window.innerWidth<768?60:120;for(let e=0;e<t;e++)l.push(new A)}function x(){if(d){t=requestAnimationFrame(x),o.clearRect(0,0,r,i);for(let t=0;t<l.length;t++){var n=l[t];n.update(),n.draw();for(let e=t+1;e<l.length;e++){var a=l[e],s=Math.sqrt(Math.pow(n.x-a.x,2)+Math.pow(n.y-a.y,2));s<160&&(o.beginPath(),o.moveTo(n.x,n.y),o.lineTo(a.x,a.y),a=document.body.classList.contains("dark-theme"),o.strokeStyle=a?`rgba(244, 114, 182, ${.25-s/160*.25})`:`rgba(212, 0, 109, ${.1-s/160*.1})`,o.lineWidth=.8,o.stroke())}}}}window.addEventListener("resize",w),w(),x()}let I=document.getElementById("main-nav"),k=document.getElementById("scroll-progress");window.addEventListener("scroll",()=>{var e;I&&(50<window.scrollY?I.classList.add("nav-scrolled"):I.classList.remove("nav-scrolled")),k&&(e=(document.body.scrollTop||document.documentElement.scrollTop)/(document.documentElement.scrollHeight-document.documentElement.clientHeight)*100,k.style.width=e+"%")}),"undefined"!=typeof AOS&&AOS.init({duration:1e3,once:!0,offset:100});c="https://wa.me/525613388030?text="+encodeURIComponent("Hola JBDA, solicito información de consultoría.");document.getElementById("link-whatsapp-footer")&&(document.getElementById("link-whatsapp-footer").href=c),document.getElementById("link-concierge-whatsapp")&&(document.getElementById("link-concierge-whatsapp").href=c),document.getElementById("link-linkedin")&&(document.getElementById("link-linkedin").href="https://www.linkedin.com/company/jbdamx/");c=e=>(e.preventDefault(),Calendly.initPopupWidget({url:"https://calendly.com/jbda_tech/diagnostico"}),document.getElementById("concierge-menu").classList.remove("active"),!1);document.getElementById("link-hero")&&document.getElementById("link-hero").addEventListener("click",c),document.getElementById("link-cta")&&document.getElementById("link-cta").addEventListener("click",c),document.getElementById("link-concierge-calendly")&&document.getElementById("link-concierge-calendly").addEventListener("click",c);let B=document.getElementById("concierge-toggle"),M=document.getElementById("concierge-menu");B&&M&&(B.addEventListener("click",e=>{e.stopPropagation(),M.classList.toggle("active")}),document.addEventListener("click",e=>{B.contains(e.target)||M.contains(e.target)||M.classList.remove("active")}));c=document.getElementById("terminal-toggle");c&&c.addEventListener("click",e=>{e.stopPropagation(),document.body.classList.toggle("terminal-mode")}),document.addEventListener("contextmenu",e=>e.preventDefault()),document.addEventListener("keydown",e=>{(123===e.keyCode||e.ctrlKey&&e.shiftKey&&(73===e.keyCode||74===e.keyCode)||e.ctrlKey&&85===e.keyCode)&&e.preventDefault()})}),document.addEventListener("DOMContentLoaded",()=>{let t=document.getElementById("hamburger-btn"),n=document.getElementById("mobile-menu-overlay");var e=document.querySelectorAll(".mobile-link");t&&n&&(t.addEventListener("click",()=>{t.classList.toggle("active"),n.classList.toggle("active"),n.classList.contains("active")?document.body.style.overflow="hidden":document.body.style.overflow=""}),e.forEach(e=>{e.addEventListener("click",()=>{t.classList.remove("active"),n.classList.remove("active"),document.body.style.overflow=""})}))});